<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>福岡之旅 | Fukuoka Trip</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #D6EAF8; margin: 0; padding-bottom: 80px; }
        .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 24px; border: 1px solid rgba(255,255,255,0.3); }
        .curved-header { border-radius: 0 0 40px 40px; overflow: hidden; position: relative; height: 220px; background: white; }
        .banner-img { width: 100%; height: 100%; object-fit: cover; }
        .content-up { margin-top: -60px; position: relative; z-index: 20; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        [v-cloak] { display: none; }
    </style>
</head>
<body>
    <div id="app" v-cloak class="max-w-md mx-auto min-h-screen relative">
        
        <header class="curved-header shadow-lg">
            <img src="IMG_0144.JPG" alt="Banner" class="banner-img" onerror="this.src='https://placehold.co/800x400?text=IMG_0144.JPG'">
            <div class="absolute bottom-16 right-4 flex space-x-2 bg-white/80 backdrop-blur-md p-1.5 rounded-2xl shadow-xl border border-white/50">
                <button v-for="tab in tabs" @click="activeTab = tab.id" :class="activeTab === tab.id ? 'text-blue-500' : 'text-gray-400'" class="p-2 transition-colors">
                    <i :data-lucide="tab.icon"></i>
                </button>
            </div>
        </header>

        <main class="content-up px-4">
            
            <div v-if="activeTab === 'itinerary'">
                <div class="flex space-x-3 overflow-x-auto hide-scrollbar py-4">
                    <div v-for="day in dates" @click="selectedDate = day.date" 
                         :class="selectedDate === day.date ? 'bg-blue-500 text-white shadow-lg' : 'bg-white/90 text-gray-500'" 
                         class="flex-shrink-0 w-16 h-20 rounded-2xl flex flex-col items-center justify-center cursor-pointer transition-all">
                        <span class="text-[10px] font-black uppercase">{{ day.weekday }}</span>
                        <span class="text-xl font-bold">{{ day.dayNum }}</span>
                    </div>
                </div>

                <div class="glass-card p-4 mb-4 flex items-center justify-between border-l-4 border-l-blue-400">
                    <div class="flex items-center">
                        <i data-lucide="cloud-snow" class="text-blue-400 mr-3"></i>
                        <div>
                            <p class="text-[10px] text-gray-400 font-bold uppercase">Fukuoka</p>
                            <p class="text-lg font-bold text-gray-800">4°C <span class="text-xs font-normal text-gray-400">體感 1°C</span></p>
                        </div>
                    </div>
                    <span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full font-bold">下雪中</span>
                </div>

                <div class="space-y-4">
                    <div v-for="(item, index) in filteredItinerary" :key="index">
                        
                        <div v-if="item.category === '航班'" class="bg-gradient-to-br from-blue-600 to-blue-400 text-white p-5 rounded-[32px] shadow-lg mb-2">
                            <div class="flex justify-between items-center mb-3 text-[10px] font-bold uppercase">
                                <span>{{ item.name }}</span>
                                <span class="bg-white/20 px-2 py-0.5 rounded">{{ item.flightNo || 'AK1510' }}</span>
                            </div>
                            <div class="flex justify-between items-center text-center">
                                <div><h3 class="text-2xl font-black">TPE</h3><p class="text-xs">{{ item.time }}</p></div>
                                <div class="flex-1 px-4"><div class="border-t border-dashed border-white/40 relative"><i data-lucide="plane" class="absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 rotate-90"></i></div></div>
                                <div><h3 class="text-2xl font-black">FUK</h3><p class="text-xs">{{ item.arrTime || '15:15' }}</p></div>
                            </div>
                        </div>

                        <div v-else class="glass-card p-5 relative shadow-sm border border-white" @click="openMap(item.name)">
                            <div class="flex justify-between items-start">
                                <span class="text-[9px] bg-blue-50 text-blue-500 px-2 py-0.5 rounded-full font-black uppercase">{{ item.category }}</span>
                                <i data-lucide="navigation" class="w-4 h-4 text-blue-400"></i>
                            </div>
                            <h3 class="font-bold text-gray-800 text-lg mt-1">{{ item.name }}</h3>
                            <p class="text-xs text-gray-500 mt-1"><i data-lucide="clock" class="inline w-3 h-3 mr-1"></i> {{ item.time }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="activeTab === 'info'" class="space-y-4 py-4">
                <div v-for="info in infoList" :key="info.id" class="glass-card p-5 relative border border-white shadow-sm cursor-pointer" @click="openMap(info.content)">
                    <div class="flex justify-between items-start">
                        <h4 class="font-bold text-gray-800 flex items-center"><i data-lucide="info" class="w-4 h-4 mr-2 text-blue-400"></i>{{ info.title }}</h4>
                    </div>
                    <p class="text-sm text-gray-500 mt-2 leading-relaxed whitespace-pre-line">{{ info.content }}</p>
                    <div v-if="info.title.includes('住宿') || info.title.includes('飯店')" class="mt-3 text-[10px] text-blue-500 font-bold flex items-center">
                        <i data-lucide="map" class="w-3 h-3 mr-1"></i> 點擊此卡片直接跳轉 Google 地圖導航
                    </div>
                </div>
            </div>

            <div v-if="activeTab === 'shopping'" class="grid grid-cols-2 gap-4 py-4">
                <div v-for="shop in shoppingList" :key="shop.id" class="glass-card p-2 relative text-center border border-white shadow-sm overflow-hidden">
                    <img :src="shop.image || 'https://placehold.co/200x200'" class="w-full h-32 object-cover rounded-xl mb-2">
                    <p class="font-bold text-xs text-gray-700 truncate px-1">{{ shop.name }}</p>
                </div>
            </div>

            <div v-if="activeTab === 'expenses'" class="space-y-3 py-4">
                <div class="bg-blue-600 rounded-[32px] p-6 text-white mb-6 shadow-lg">
                    <p class="text-xs opacity-70 mb-1 font-bold">總支出 (JPY)</p>
                    <h2 class="text-4xl font-bold">¥ {{ totalExpenses.toLocaleString() }}</h2>
                </div>
                <div v-for="ex in expenses" :key="ex.id" class="glass-card p-4 flex justify-between items-center relative border border-white shadow-sm">
                    <div>
                        <span class="text-[8px] bg-blue-50 text-blue-500 px-1.5 py-0.5 rounded font-bold mr-1">{{ ex.category }}</span>
                        <p class="font-bold text-gray-800 inline-block">{{ ex.name }}</p>
                    </div>
                    <p class="font-bold text-red-500">¥ {{ ex.amount }}</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, nextTick, watch } = Vue;
        createApp({
            setup() {
                const activeTab = ref('itinerary');
                const selectedDate = ref('1/6');

                const tabs = [
                    { id: 'itinerary', icon: 'map-pin', name: '行程' },
                    { id: 'info', icon: 'info', name: '資訊' },
                    { id: 'shopping', icon: 'shopping-basket', name: '購物' },
                    { id: 'expenses', icon: 'banknote', name: '花費' }
                ];

                const dates = [
                    { weekday: 'Mon', dayNum: '6', date: '1/6' },
                    { weekday: 'Tue', dayNum: '7', date: '1/7' },
                    { weekday: 'Wed', dayNum: '8', date: '1/8' },
                    { weekday: 'Thu', dayNum: '9', date: '1/9' }
                ];

                // 修正後的數據：統一使用 category 而非 type，並確保日期格式一致
                const itineraryItems = ref([
                    { date: '1/6', category: '航班', name: '去程航班', flightNo: 'AK1510', time: '11:55', arrTime: '15:15' },
                    { date: '1/6', category: '景點', name: 'LaLaport 福岡', time: '17:00' },
                    { date: '1/9', category: '航班', name: '返程航班', flightNo: 'AK1511', time: '16:30', arrTime: '18:10' }
                ]);

                const infoList = ref([
                    { id: 1, title: '住宿資訊', content: 'The BREAKFAST HOTEL 福岡中洲\n福岡縣福岡市博多區中洲3-6-19' }
                ]);

                const shoppingList = ref([]);
                const expenses = ref([]);

                const filteredItinerary = computed(() => {
                    return itineraryItems.value.filter(i => i.date === selectedDate.value);
                });

                const totalExpenses = computed(() => {
                    return expenses.value.reduce((s, i) => s + (i.amount || 0), 0);
                });

                // 修正導航函數語法
                const openMap = (q) => {
                    window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(q)}`, '_blank');
                };

                onMounted(() => lucide.createIcons());
                watch(activeTab, () => nextTick(() => lucide.createIcons()));
                watch(selectedDate, () => nextTick(() => lucide.createIcons()));

                return { activeTab, tabs, dates, selectedDate, filteredItinerary, infoList, shoppingList, expenses, totalExpenses, openMap };
            }
        }).mount('#app');
    </script>
</body>
</html>
